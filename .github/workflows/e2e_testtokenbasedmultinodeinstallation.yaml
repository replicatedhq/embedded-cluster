# this file has been generated by e2e/hack/create-e2e-workflows.sh.
# edit there if you want to change something.
name: E2E - TestTokenBasedMultiNodeInstallation
on:
- pull_request
jobs:
  e2e:
    name: E2E - TestTokenBasedMultiNodeInstallation
    runs-on: ubuntu-latest
    steps:
    - name: Move Docker aside
      run: |
        sudo systemctl stop docker
        sudo iptables -F
        sudo iptables -P FORWARD ACCEPT
    - name: Checkout
      uses: actions/checkout@v3
    - name: Install and Configure LXD
      run: |
        sudo lxd init --auto
        sudo snap set lxd daemon.group=adm
        sudo snap restart lxd
        sudo lxd waitready
    - name: Install and configure OVN
      run: |
        sudo apt install ovn-host ovn-central -y
        sudo ovs-vsctl set open_vswitch .           external_ids:ovn-remote=unix:/var/run/ovn/ovnsb_db.sock           external_ids:ovn-encap-type=geneve           external_ids:ovn-encap-ip=127.0.0.1
    - name: Setup Go
      uses: actions/setup-go@v4
      with:
        go-version: "1.21.0"
    - name: E2E tests (TestTokenBasedMultiNodeInstallation)
      run: |
        make e2e-test TEST_NAME=TestTokenBasedMultiNodeInstallation
